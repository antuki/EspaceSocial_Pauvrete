---
title: |
    | Fiche de modélisations n°4
subtitle : "Modèles économétriques 'explicatifs'"
author: |
    | Kim Antunez
automaticcontents: true
output:
  bookdown::pdf_document2:
        toc: true
        toc_depth: 2
        number_sections: true
        fig_caption: true
        highlight: default
        keep_tex: no
        includes:
          in_header: preamble.tex
themeoptions: "coding=utf8,language=french"
classoption: 'french'
fontsize: 11pt
geometry: margin=0.90in
lang: "french"
documentclass: "article"
---

```{r setup, echo=FALSE, cache=FALSE}
library(knitr)
#library(rmdformats)

## Global options
#options(max.print="75")
opts_chunk$set(echo=TRUE,
	             cache=FALSE,
               prompt=FALSE,
               tidy=FALSE,
               comment=NA,
               message=FALSE,
               warning=FALSE,
               fig.width = 5,
               fig.height = 3
               )
options(knitr.kable.NA = '')
#opts_knit$set(width=75)
```


# Objectif

L'objectif de cette quatrième série de modèles est de voir ce qui se passe lorsque l'on propose des modèles alternatifs à ceux proposés par Duvoux et Papuchon (2018).

# Analyses

::::{.tcolorbox data-latex= } 
On construit des modèles permettant d’expliquer les variables de pauvreté subjective : 

1.	Le fait de se sentir pauvre (sentiment de pauvreté) [approche binaire cf. partie \@ref(pauvsub)] ou de penser le devenir (risque de pauvreté) [approche multinomiale cf. parties \@ref(multinom) et \@ref(ordinal) ]
2.	Le fait de juger que son revenu est inférieur au revenu minimal jugé pour vivre [cf. partie \@ref(infminidecla)]
3.	Le fait de ne pas se sentir suffisamment aidé par les pouvoir publics [cf. partie \@ref(pouvpub)]

Les différentes variables s’expliquent relativement bien avec des pseudo-$R^2$ montant jusqu’à 20-25 % en incluant différentes variables de contrôle. 

\bigskip

Le niveau de vie est déterminant pour prévoir ces variables. Il explique à lui seul une bonne partie de la variance des modèles. La pauvreté institutionnelle (recevoir des prestations sociales) arrive ensuite, en particulier pour le sentiment de pauvreté, légèrement moins pour les deux indicateurs suivants.


\bigskip

D’autres variables jouent un rôle sur le sentiment de pauvreté (partie \@ref(pauvsub)), en particulier le fait d’être locataire, de vivre seul, d’être peu diplômé ou avoir dans son entourage quelqu’un au RSA. Les 18-29 ans, inactifs (hors chômeurs et retraités) et ouvriers^[La PCS, prise seule ou non, explique de manière plus importante le sentiment de pauvreté que le statut d’activité et type de contrat] sont également particulièrement touchés.


\bigskip

Moins de variables ressortent pour les deux autres indicateurs (parties \@ref(infminidecla) et \@ref(pouvpub)) de pauvreté subjective : surtout la structure familiale demeure significative.

\bigskip

La mise en place de **modèles multinomiaux** (partie \@ref(multinom)) permet de comparer les variables qui jouent sur le sentiment de pauvreté, versus celles qui jouent sur le fait de penser risquer devenir pauvre dans les 5 prochaines années. Dans la grande majorité des cas, ce sont les mêmes variables qui jouent^[ce qui peut aller dans le sens de la mise en place d’un modèle ordinal, fait en partie \@ref(ordinal)], avec une ampleur moins importante pour le risque de pauvreté par rapport au sentiment de pauvreté. C’est le cas pour le niveau de vie et autres revenus financiers et locatifs, le statut d’occupation du logement, le niveau de diplôme, la vie familiale. Quelques variables se distinguent par un effet légèrement différencié entre les deux modalités : 

1. La pauvreté institutionnelle. Alors qu’être bénéficiaire du RSA joue un rôle plus fort sur le sentiment de pauvreté que de bénéficier d’une allocation chômage, pour le risque de pauvreté le chômage joue un rôle plus important que le RSA
2. La CSP / statut d’occupation. La CSP d’ouvrier a un effet fort sur le risque de pauvreté, il passe devant les inactifs et au foyer qui ont un effet plus fort pour le sentiment de pauvreté. 


\bigskip

S’agissant des **modèles ordinaux** -- multinomiaux ordonnés (partie \@ref(ordinal)), ils ne permettent pas d’obtenir des interprétations supplémentaires de celles des modèles multinomiaux non ordonnés. Si ce n’est qu’ils permettent d’observer dans le modèle final que la constante de passage de la modalité « Non je ne suis pas pauvre » à « Non je ne suis pas pauvre mais risque de le devenir dans 5 ans » n’est pas significative alors que celle entre cette dernière et « Oui je suis pauvre » est forte et significative. En termes d’interprétation, cela voudrait dire que le gap est plus grand entre le passage d’une pauvreté probable dans 5 ans à la pauvreté est plus grand que celui du non-risque de pauvreté à celui de pauvreté potentielle dans 5 ans. 

::::





**Petites remarques complémentaires**

- Nous avons testé l’ajout dans nos modèles d’une variable permettant de renseigner si l’individu travail ou non en tant qu’indépendant. Cette variable est moins significative que de nombreux autres statuts d’emploi
- Il y a une zone de flou dans les modèles dans le sens où la richesse s’établit en général au niveau du ménage. Les revenus (du salaire mais aussi les prestations sociales) sont appréciés au niveau du ménage mais pas les emplois. On remarque d’ailleurs à ce sujet que la profession et le statut d’activité de la personne référence expliquent mieux (meilleur pseudo-$R^2$) le sentiment de pauvreté que ces mêmes variables concernant l’enquêté. Il faudrait en théorie ajouter les deux professions mais ces variables étant très corrélées (homogamie), cela brouille l’interprétation des régressions.


# Code et résultats

```{r}
#chargement des packages
library(knitr)
library(nnet) #pour les regressions multinomiales
library(MASS) #pour les regressions ordinales
library(dplyr) #manipuler les bases de données
library(tidyr) #pour pivot_longer
library(ggplot2) #pour les graphiques
library(naniar) #diagnostics valeurs manquantes

```

```{r, echo=FALSE}
bdd <- readRDS("../data/2019/barometre2000_2019_diff.rds") %>% 
  filter(annee%in%2015:2019) #NEW : 2015 à 2019

revenus_a_imputer <- bdd %>%
mutate(sdrevcl = ifelse(sdrevcl==999999999,NA,sdrevcl)) %>%
group_by(sdrevtr) %>% 
summarise(sdrevcl = mean(sdrevcl,na.rm=TRUE))

bdd <- bdd %>%   mutate(
    sdrevcl_imput_moy = case_when(
      sdrevcl!=999999999 ~ sdrevcl,
      sdrevcl==999999999 & sdrevtr==1 ~ revenus_a_imputer$sdrevcl[1],
      sdrevcl==999999999 & sdrevtr==2 ~ revenus_a_imputer$sdrevcl[2],
      sdrevcl==999999999 & sdrevtr==3 ~ revenus_a_imputer$sdrevcl[3],
      sdrevcl==999999999 & sdrevtr==4 ~ revenus_a_imputer$sdrevcl[4],
      sdrevcl==999999999 & sdrevtr==5 ~ revenus_a_imputer$sdrevcl[5],
      sdrevcl==999999999 & sdrevtr==6 ~ revenus_a_imputer$sdrevcl[6],
      sdrevcl==999999999 & sdrevtr==7 ~ revenus_a_imputer$sdrevcl[7]
             )
  )

bdd <- bdd %>% 
   mutate(seuil_pauvrete = do.call(c,lapply(annee,function(annee_selec){
0.6*median(bdd[bdd$annee==annee_selec,"sdrevcl_imput_moy"]/bdd[bdd$annee==annee_selec,"sduc"],
           na.rm=TRUE)
}
))) %>% 
   mutate(subj_inf_mini_decla = sdrevcl_imput_moy - ifelse(pe16==999999999,NA,pe16) <0) %>% 
  mutate(subj_pauvrete = 
           ifelse(pe3==3, TRUE,ifelse(pe3==4,NA,FALSE))) %>% 
  mutate(subj_risque_pauvrete = 
           ifelse(pe3==1, TRUE,ifelse(pe3==4,NA,FALSE))) %>% 
  mutate(subj_pauvrete_et_risque = 
           factor(
           ifelse(pe3==4, NA, ifelse(pe3==1,2,ifelse(pe3==2,1,3))),
           labels=c("Non pauvre","Risque pauvreté futur", "Déjà pauvre"))
         ) %>% 
  mutate(subj_besoin_aide_etat =
           ifelse(pe15==2, TRUE,ifelse(pe15==4,NA,FALSE))) %>%
  mutate(obj_pauvrete= sdrevcl_imput_moy/sduc<seuil_pauvrete)

bdd <- bdd %>% 
  mutate(
    prof_exercee_ou_derniere = case_when(
      sdpcs7%in%c(1,2) ~ "Agriculteurs, artisans et commerçants",
      sdpcs7%in%c(3) ~ "Cadre supérieur, profession libérale",
      sdpcs7%in%c(4) ~ "Profession intermédiaire",
      sdpcs7%in%c(5) ~ "Employé",
      sdpcs7%in%c(6) ~ "Ouvrier",
      sdpcs7%in%c(7) ~ "Autres (n'ayant jamais travaillé)"
    )
  ) %>% 
  mutate(
    activite_actuelle = case_when(
      sdsitua==4 ~ "Chômeur",
      sdsitua==6 ~ "Retraité",
      (sdsitua==1 & sdstatemp!=1) | sdsitua%in%c(2,3) ~
        "Emploi précaire/temps partiel",
      TRUE #sdsitua%in%c(5,7) | (sdsitua==1 & sdstatemp==1) incomplet
      ~
        "Autres (CDI à temps plein, étudiants en formations et personnes n'ayant jamais travaillé)"
    )
  )%>% 
  mutate(
    PCS_recode = case_when(
      prof_exercee_ou_derniere%in%c("Employé","Ouvrier") & activite_actuelle=="Emploi précaire/temps partiel" ~
        "Employés et ouvriers\nprécaires ou\ntemps partiels",
      prof_exercee_ou_derniere%in%c("Employé","Ouvrier") & activite_actuelle=="Retraité" ~
        "Employés et ouvriers\nà la retraite", #sdsitua==6
      prof_exercee_ou_derniere%in%c("Employé","Ouvrier") & activite_actuelle=="Chômeur"  ~
        "Employés et ouvriers\nau chômage",
      sdsitua==1 & !(prof_exercee_ou_derniere%in%c("Employé","Ouvrier") & activite_actuelle=="Emploi précaire/temps partiel") ~ "En emploi à temps plein",
      sdsitua%in%c(7)  ~ "Sans activité\nprofessionnelle",
      TRUE                      ~  "Autres"
    )
  ) %>% 
  mutate(
    sitfam = case_when(
      sdsitfam==2 ~ "Membre du couple",
      sdsitfam==1 ~ "Vie seule",
      sdsitfam==3 ~ "Famille monoparentale",
      sdsitfam%in%c(4,5,6,7) ~ "Autre situation (enfant de la famille,\nami ou parent hébergé, colocataire)" 
      #pas précisé si prise compte de 7 mais très peu d'individus
    )
  ) %>% 
  mutate(
    crois_pauvrete_obj_subj = case_when(
      !subj_pauvrete & !obj_pauvrete & !is.na(subj_pauvrete) & !is.na(obj_pauvrete)  ~
        "Au-dessus du seuil\net ne se sent pas pauvre",
      !subj_pauvrete & obj_pauvrete & !is.na(subj_pauvrete) & !is.na(obj_pauvrete) ~
        "Sous le seuil\nmais ne se sent pas pauvre",
      subj_pauvrete & !obj_pauvrete & !is.na(subj_pauvrete) & !is.na(obj_pauvrete) ~
        "Au-dessus du seuil\nmais se sent pauvre",
      subj_pauvrete & obj_pauvrete & !is.na(subj_pauvrete) & !is.na(obj_pauvrete)~
        "Pauvreté monétaire\net ressentie"
    )
  ) %>% 
#sdres_3 : RSA, sdres_4 : chômage, sdres_10 : handicap dépdce.
  mutate(
    assistance = case_when(
      sdres_3==1 | sdres_4==1 | sdres_10==1 ~ TRUE,
      sdres_3==2 & sdres_4==2 & sdres_10==2 ~ FALSE,
      TRUE ~ NA
      )
  ) %>% 
  mutate(
    pessimisme = case_when(
      og3_1%in%c(1,2) ~ FALSE,
      og3_1%in%c(3,4) ~ TRUE,
      og3_1%in%c(5) ~ NA
      )
  ) %>% 
  mutate(
    declassement = case_when(
      #og2_ab%in%c(1,2) | og2_cd%in%c(4,5)  ~ TRUE,
      #og2_ab%in%c(3,4,5) | og2_cd%in%c(1,2,3) ~ FALSE,
      #og2_ab%in%c(6) | og2_cd%in%c(6) ~ NA
      og2%in%c(1,2) ~ TRUE,
      og2%in%c(3,4,5) ~ FALSE,
      og2%in%c(6) ~ NA
      )
  )  %>% 
  mutate(
    proprietaire = case_when(
      lo1==1 ~ TRUE,
      lo1%in%c(2,3,4) ~ FALSE,
      lo1==5 ~ NA
      )
  ) %>% 
  mutate(
    retraite = case_when(
      sdsitua==6 ~ TRUE,
       TRUE ~ FALSE
    )
  )


```


```{r, echo=FALSE}
bdd_logit <- bdd %>% 
   mutate(nivie = sdrevcl_imput_moy/sduc) %>% 
  mutate(quantile_nivie = factor(
    cut(sdrevcl_imput_moy/sduc, include.lowest=TRUE,
        breaks=quantile(sdrevcl_imput_moy/sduc,
                        probs=seq(0,1,0.2),na.rm=TRUE),
        labels=1:5),
    levels=c(2,1,3,4,5),
    labels=paste0("-Quintile ",c(2,1,3,4,5)))
  ) %>% 
  mutate(
    statact = factor(case_when(
      sdsitua==1 & sdstatemp%in%c(1)   ~ 1,
      sdsitua%in%c(2,3) | (sdsitua==1 & sdstatemp%in%c(NA,2,3,4,5)) ~ 2,
      sdsitua==4 ~ 3,
      sdsitua==5 ~ 4,
      sdsitua==6 ~ 5,
      sdsitua==7 ~ 6,
      TRUE ~ NA_real_
    ),
    levels=1:6,
    labels=paste0("-",
                  c("CDI temps plein",
                    "Emploi précaire ou à temps partiel",
                    "Recherche d’emploi",
                    "Étudiant",
                    "Retraité",
                    "Aucune activité professionnelle"))
    )) %>%
  # fastDummies::dummy_cols(select_columns = 'prof') %>% 
  mutate(
    diplome = factor(case_when(
      sddipl%in%c(1,2,3,4) ~ 1,
      sddipl%in%c(5,6) ~ 2,
      sddipl%in%c(7) ~ 3,
      sddipl%in%c(8) ~ 4,
      TRUE ~ NA_real_
    ),
    levels=c(2,1,3,4),
    labels=paste0("-",c("Baccalauréat","CAP, BEP ou moins","Bac + 2","Bac + 3 ou plus"))
    )) %>% 
  mutate(aide_log = factor(
    ifelse(sdres_9!=3,sdres_9,NA),
    levels=c(2,1),
    labels=paste0("-",c("Pas d'aide au logement","Aide au logement reçue"))
  )) %>% 
  mutate(aide_rsa = factor(
    ifelse(sdres_3!=3,sdres_3,NA),
    levels=c(2,1),
    labels=paste0("-",c("Pas de RSA","RSA reçu"))
  )) %>% 
  mutate(aide_handi = factor(
    ifelse(sdres_10!=3,sdres_10,NA),
    levels=c(2,1),
    labels=paste0("-",c("Pas d'alloc. hand./invalid./dépend.",
                        "Alloc. hand./invalid./dépend. reçu"))
  )) %>% 
  mutate(sexe = factor(
    ifelse(sdsexe!=3,sdsexe,NA),
    levels=c(2,1),
    labels=paste0("-",c("Femme","Homme"))
  )) %>% 
  mutate(age_tranche = factor(
    cut(sdage,
        breaks=c(18,30,40,50,60,70,120),
        include.lowest=TRUE,
        labels=1:6),
    levels=c(2,1,3,4,5,6),
    labels=paste0("-",c("30 à 39 ans","18 à 29 ans","40 à 49 ans",
                        "50 à 59 ans","60 à 69 ans", "70 ans et plus")))
  ) %>% 
  mutate(
    vie_fam = factor(case_when(
      sdsitfam==1 ~ 1,
      #sdsitfam==2 & sdnbenf==0 ~ 2,
      #sdsitfam==2 & sdnbenf!=0 ~ 3,
      sdsitfam==2 & sdnbenf==1 ~ 2,
      sdsitfam==2 & sdnbenf!=1 ~ 3,
      sdsitfam==3 ~ 4,
      sdsitfam==4 ~ 5,
      sdsitfam%in%c(5,6,7) ~ 6,
      TRUE ~ NA_real_
    ),
    levels=c(2,1,3,4,5,6),
    labels=paste0("-",
                  c("Membre du couple (pas d’enfants à charge)","Vit seul",
                    "Membre du couple (enfants à charge)", "Chef famille monoparentale",
                    "Enfant","Autre situation familiale"))
    )) %>% 
  mutate(
    statut_occup0 = factor(case_when(
      lo1%in%c(2,3,4)  ~ 1,
      lo1==1 ~ 2,
      lo1==5 ~ NA_real_
   ),
    levels=c(1,2),
    labels=paste0("-",
                  c("Locataire ou hébergé","Propriétaire ")) 
    )) %>% 
  mutate(
    statut_occup = factor(case_when(
      lo1%in%c(3,4)  ~ 1,
      lo1==2  ~ 2,
      lo1==1 ~ 3,
      lo1==5 ~ NA_real_
   ),
    levels=c(1,2,3),
    labels=paste0("-",
                  c("Locataire privé / hébergé",
                    "Locataire HLM","Propriétaire")) 
    )) %>% 
  mutate(annee_fac = factor(annee,labels=paste0("-",2015:2019))) %>% 
  mutate(annee_fac_paires = factor(ifelse(annee%in%c(2016,2018),annee,NA),labels=paste0("-",c(2016,2018)))) %>% 
  mutate(pauvrete_mon_rel= factor(
    ifelse(sdrevcl_imput_moy/sduc<seuil_pauvrete,3,
                                  ifelse(sdrevcl_imput_moy/sduc>=1.2*seuil_pauvrete,1,
                                         ifelse(sdrevcl_imput_moy/sduc<1.2*seuil_pauvrete &
                                                  sdrevcl_imput_moy/sduc>=seuil_pauvrete ,
                                                2,NA)
                                  )),
    levels=c(1,2,3),
    labels=paste0("-",c("Revenus > 20 pourcents seuil pauvreté",
                        "Entre le seuil et 20 pourcents au dessus",
                        "Pauvreté monétaire"))
  )
  )

# bdd_logit <- bdd_logit %>% mutate(sdniviecl_imput_quint = 
# factor(
#     cut(sdniviecl_imput, include.lowest=TRUE,
#         breaks=quantile(sdniviecl_imput,
#                         probs=seq(0,1,0.2),na.rm=TRUE),
#         labels=1:5),
#     levels=c(2,1,3,4,5),
#     labels=paste0("-Quintile ",c(2,1,3,4,5))))

#NEW depuis fiche 3
 bdd_logit <- bdd_logit %>% #chômeur indemnise 
  mutate(
    conn_choindemnise = factor(case_when(
      sdproxim_1%in%c(1,4)  ~ 1,
      sdproxim_1%in%c(2,3,5,6,7,8)  ~ 2,
      sdproxim_1==9 ~ NA_real_
   ),
    levels=c(1,2),
    labels=paste0("-",
                  c("Ne connaît pas de chômeur indemnisé",
                    "Connait un chômeur indemnisé")) 
    )) %>% 
  mutate(
    est_choindemnise = factor(case_when(
      sdproxim_1%in%c(4,6,7,8)  ~ 2,
      sdproxim_1%in%c(1,2,3,5)  ~ 1,
      sdproxim_1==9 ~ NA_real_
   ),
    levels=c(1,2),
    labels=paste0("-",
                  c("N'est pas chômeur indemnisé",
                    "est chômeur indemnisé")) 
    )) %>%
  mutate(
    conn_chononindemnise = factor(case_when(
      sdproxim_2%in%c(1,4)  ~ 1,
      sdproxim_2%in%c(2,3,5,6,7,8)  ~ 2,
      sdproxim_2==9 ~ NA_real_
   ),
    levels=c(1,2),
    labels=paste0("-",
                  c("Ne connaît pas de chômeur non indemnisé",
                    "Connait un chômeur non indemnisé")) 
    )) %>% 
  mutate(
    est_chononindemnise = factor(case_when(
      sdproxim_2%in%c(4,6,7,8)  ~ 2,
      sdproxim_2%in%c(1,2,3,5)  ~ 1,
      sdproxim_2==9 ~ NA_real_
   ),
    levels=c(1,2),
    labels=paste0("-",
                  c("N'est pas chômeur non indemnisé",
                    "est chômeur non indemnisé")) 
    )) %>% #SDF
  mutate(
    conn_sdf = factor(case_when(
      sdproxim_3%in%c(1,4)  ~ 1,
      sdproxim_3%in%c(2,3,5,6,7,8)  ~ 2,
      sdproxim_3==9 ~ NA_real_
   ),
    levels=c(1,2),
    labels=paste0("-",
                  c("Ne connaît pas de SDF",
                    "Connait un SDF")) 
    )) %>% 
  mutate(
    est_sdf = factor(case_when(
      sdproxim_3%in%c(4,6,7,8)  ~ 2,
      sdproxim_3%in%c(1,2,3,5)  ~ 1,
      sdproxim_3==9 ~ NA_real_
   ),
    levels=c(1,2),
    labels=paste0("-",
                  c("N'est pas SDF",
                    "est SDF")) 
    )) %>% #personne élevant seul ses enfants avec moins du SMIC 
  mutate(
    conn_eleveseulsmic = factor(case_when(
      sdproxim_4%in%c(1,4)  ~ 1,
      sdproxim_4%in%c(2,3,5,6,7,8)  ~ 2,
      sdproxim_4==9 ~ NA_real_
   ),
    levels=c(1,2),
    labels=paste0("-",
                  c("Ne connaît pas de personne élevant seul ses enfants avec moins du SMIC",
                    "Connait une personne élevant seul ses enfants avec moins du SMIC")) 
    )) %>% 
  mutate(
    est_eleveseulsmic = factor(case_when(
      sdproxim_4%in%c(4,6,7,8)  ~ 2,
      sdproxim_4%in%c(1,2,3,5)  ~ 1,
      sdproxim_4==9 ~ NA_real_
   ),
    levels=c(1,2),
    labels=paste0("-",
                  c("N'est pas personne élevant seul ses enfants avec moins du SMIC",
                    "est personne élevant seul ses enfants avec moins du SMIC")) 
    )) %>% #pensionné invalide indicapé ne pouvant pas travailler 
  mutate(
    conn_pensionhandi = factor(case_when(
      sdproxim_5%in%c(1,4)  ~ 1,
      sdproxim_5%in%c(2,3,5,6,7,8)  ~ 2,
      sdproxim_5==9 ~ NA_real_
   ),
    levels=c(1,2),
    labels=paste0("-",
                  c("Ne connaît pas de pensionné invalide indicapé ne pouvant pas travailler",
                    "Connait un pensionné invalide indicapé ne pouvant pas travailler")) 
    )) %>% 
  mutate(
    est_pensionhandi = factor(case_when(
      sdproxim_5%in%c(4,6,7,8)  ~ 2,
      sdproxim_5%in%c(1,2,3,5)  ~ 1,
      sdproxim_5==9 ~ NA_real_
   ),
    levels=c(1,2),
    labels=paste0("-",
                  c("N'est pas pensionné invalide indicapé ne pouvant pas travailler",
                    "est pensionné invalide indicapé ne pouvant pas travailler")) 
    )) %>% #personne en emploi précaire 
  mutate(
    conn_emploiprecaire = factor(case_when(
      sdproxim_6%in%c(1,4)  ~ 1,
      sdproxim_6%in%c(2,3,5,6,7,8)  ~ 2,
      sdproxim_6==9 ~ NA_real_
   ),
    levels=c(1,2),
    labels=paste0("-",
                  c("Ne connaît pas de personne en emploi précaire",
                    "Connait une personne en emploi précaire")) 
    )) %>% 
  mutate(
    est_emploiprecaire = factor(case_when(
      sdproxim_6%in%c(4,6,7,8)  ~ 2,
      sdproxim_6%in%c(1,2,3,5)  ~ 1,
      sdproxim_6==9 ~ NA_real_
   ),
    levels=c(1,2),
    labels=paste0("-",
                  c("N'est pas personne en emploi précaire",
                    "est personne en emploi précaire")) 
    )) %>%  mutate(
    conn_rsa_fam = factor(case_when(
      sdproxim_7%in%c(1,3,4,7)  ~ 1,
      sdproxim_7%in%c(2,5,6,8)  ~ 2,
      sdproxim_7==9 ~ NA_real_
   ),
    levels=c(1,2),
    labels=paste0("-",
                  c("Ne connaît pas de personne dans sa famille au RSA",
                    "Connait une personne dans sa famille au RSA")) 
    )) %>%
   mutate(
    conn_rsa_horsfam = factor(case_when(
      sdproxim_7%in%c(1,2,4,6)  ~ 1,
      sdproxim_7%in%c(3,5,7,8)  ~ 2,
      sdproxim_7==9 ~ NA_real_
   ),
    levels=c(1,2),
    labels=paste0("-",
                  c("Ne connaît pas de personne hors de sa famille au RSA",
                    "Connait une personne hors de sa famille au RSA")) 
    )) %>% #personne au RSA 
  mutate(
    conn_rsa = factor(case_when(
      sdproxim_7%in%c(1,4)  ~ 1,
      sdproxim_7%in%c(2,3,5,6,7,8)  ~ 2,
      sdproxim_7==9 ~ NA_real_
   ),
    levels=c(1,2),
    labels=paste0("-",
                  c("Ne connaît pas de personne au RSA",
                    "Connait une personne au RSA")) 
    )) %>% 
  mutate(
    est_rsa = factor(case_when(
      sdproxim_7%in%c(4,6,7,8)  ~ 2,
      sdproxim_7%in%c(1,2,3,5)  ~ 1,
      sdproxim_7==9 ~ NA_real_
   ),
    levels=c(1,2),
    labels=paste0("-",
                  c("N'est pas personne au RSA",
                    "est personne au RSA")) 
    )) %>% #personne handicapée de moins de 60 ans
  mutate(
    conn_handijeune = factor(case_when(
      sdproxim_8%in%c(1,4)  ~ 1,
      sdproxim_8%in%c(2,3,5,6,7,8)  ~ 2,
      sdproxim_8==9 ~ NA_real_
   ),
    levels=c(1,2),
    labels=paste0("-",
                  c("Ne connaît pas de personne handicapée de moins de 60 ans",
                    "Connait une personne handicapée de moins de 60 ans")) 
    )) %>% 
  mutate(
    est_handijeune = factor(case_when(
      sdproxim_8%in%c(4,6,7,8)  ~ 2,
      sdproxim_8%in%c(1,2,3,5)  ~ 1,
      sdproxim_8==9 ~ NA_real_
   ),
    levels=c(1,2),
    labels=paste0("-",
                  c("N'est pas personne handicapée de moins de 60 ans",
                    "est personne handicapée de moins de 60 ans")) 
    )) %>% #personne âgée dépendante
  mutate(
    conn_dependant = factor(case_when(
      sdproxim_9%in%c(1,4)  ~ 1,
      sdproxim_9%in%c(2,3,5,6,7,8)  ~ 2,
      sdproxim_9==9 ~ NA_real_
   ),
    levels=c(1,2),
    labels=paste0("-",
                  c("Ne connaît pas de personne âgée dépendante",
                    "Connait une personne âgée dépendante")) 
    )) %>% 
  mutate(
    est_dependant = factor(case_when(
      sdproxim_9%in%c(4,6,7,8)  ~ 2,
      sdproxim_9%in%c(1,2,3,5)  ~ 1,
      sdproxim_9==9 ~ NA_real_
   ),
    levels=c(1,2),
    labels=paste0("-",
                  c("N'est pas personne âgée dépendante",
                    "est personne âgée dépendante")) 
    )) %>% 
  mutate(
    revenus_salaires = factor(case_when(
      sdres_1%in%c(2)  ~ 1,
      sdres_1%in%c(1)  ~ 2,
      sdres_1==3 ~ NA_real_
   ),
    levels=c(1,2),
    labels=paste0("-",
                  c("Pas de revenus de salaires",
                    "Revenus de salaires")) 
    )) %>% 
  mutate(
    revenus_independant = factor(case_when(
      sdres_2%in%c(2)  ~ 1,
      sdres_2%in%c(1)  ~ 2,
      sdres_2==3 ~ NA_real_
   ),
    levels=c(1,2),
    labels=paste0("-",
                  c("Pas de revenus d'activité indépendante",
                    "Revenus d'activité indépendante")) 
    )) %>%
  mutate(
    presta_hlm = factor(case_when(
      lo1%in%c(1,3,4) ~ 1,
      lo1==2  ~ 2,
      lo1==5 ~ NA_real_
   ),
    levels=c(1,2),
    labels=paste0("-",
                  c("Locataire privé / hébergé, Propriétaire","Locataire HLM")) 
    )) %>% 
  mutate(
    presta_rsa = factor(case_when(
      sdres_3%in%c(2)  ~ 1,
      sdres_3%in%c(1)  ~ 2,
      sdres_3==3 ~ NA_real_
   ),
    levels=c(1,2),
    labels=paste0("-",
                  c("Pas de RSA",
                    "RSA")) 
    )) %>% 
  mutate(
    presta_chomage = factor(case_when(
      sdres_4%in%c(2)  ~ 1,
      sdres_4%in%c(1)  ~ 2,
      sdres_4==3 ~ NA_real_
   ),
    levels=c(1,2),
    labels=paste0("-",
                  c("Pas d'allocation chômage",
                    "Allocation chômage")) 
    )) %>% 
  mutate(
    revenus_retraite = factor(case_when(
      sdres_5%in%c(2)  ~ 1,
      sdres_5%in%c(1)  ~ 2,
      sdres_5==3 ~ NA_real_
   ),
    levels=c(1,2),
    labels=paste0("-",
                  c("Pas de revenus de retraite",
                    "Revenus de retraite")) 
    )) %>%
  mutate(
    revenus_financiers = factor(case_when(
      sdres_6%in%c(2)  ~ 1,
      sdres_6%in%c(1)  ~ 2,
      sdres_6==3 ~ NA_real_
   ),
    levels=c(1,2),
    labels=paste0("-",
                  c("Pas de revenus d'actifs financiers",
                    "Revenus d'actifs financiers")) 
    )) %>% 
  mutate(
    revenus_locatifs = factor(case_when(
      sdres_7%in%c(2)  ~ 1,
      sdres_7%in%c(1)  ~ 2,
      sdres_7==3 ~ NA_real_
   ),
    levels=c(1,2),
    labels=paste0("-",
                  c("Pas de revenus de locations",
                    "Revenus de locations")) 
    )) %>% 
  mutate(
    presta_fam = factor(case_when(
      sdres_8%in%c(2)  ~ 1,
      sdres_8%in%c(1)  ~ 2,
      sdres_8==3 ~ NA_real_
   ),
    levels=c(1,2),
    labels=paste0("-",
                  c("Pas de prestations familiales",
                    "Prestations familiales")) 
    )) %>% 
  mutate(
    presta_apl = factor(case_when(
      sdres_9%in%c(2)  ~ 1,
      sdres_9%in%c(1)  ~ 2,
      sdres_9==3 ~ NA_real_
   ),
    levels=c(1,2),
    labels=paste0("-",
                  c("Pas d'APL",
                    "APL")) 
    )) %>% 
  mutate(
    presta_handi = factor(case_when(
      sdres_10%in%c(2)  ~ 1,
      sdres_10%in%c(1)  ~ 2,
      sdres_10==3 ~ NA_real_
   ),
    levels=c(1,2),
    labels=paste0("-",
                  c("Pas d'AAH, APA, PCH (handicap)",
                    "AAH, APA, PCH (handicap)")) 
    )) %>% 
  mutate(
    presta_etudes = factor(case_when(
      sdres_11%in%c(2)  ~ 1,
      sdres_11%in%c(1)  ~ 2,
      sdres_11==3 ~ NA_real_
   ),
    levels=c(1,2),
    labels=paste0("-",
                  c("Pas de bourse d'étude",
                    "Bourse d'étude")) 
    )) %>% 
  mutate(
    presta_pensionalim = factor(case_when(
      sdres_12%in%c(2)  ~ 1,
      sdres_12%in%c(1)  ~ 2,
      sdres_12==3 ~ NA_real_
   ),
    levels=c(1,2),
    labels=paste0("-",
                  c("Pas de pension alimentaire",
                    "pension alimentaire")) 
    )) %>% 
  mutate(
    statut_activite = factor(case_when(
      sdstat==2 & (sdsitua==1 & sdstatemp==1) ~ 1,
      sdstat==2 & !(sdsitua==1 & sdstatemp==1) ~ 2,
      sdstat==1 & (sdsitua==1 & sdstatemp==1) ~ 3,
      sdstat==1 & !(sdsitua==1 & sdstatemp==1) ~ 4,
      sdstat==3 ~ 5,
      sdstat==4 ~ 6,
      sdstat==5 ~ 7,
      sdstat==6 ~ 8,
      sdstat==7 ~ 9,
      sdstat==8 ~ NA_real_
   ),
    levels=1:9,
    labels=paste0("-",
                  c("Salarié du secteur privé (en CDI à temps plein)",
"Salarié du secteur privé (précaire ou à temps partiel)",
"Salarié du secteur public (en CDI à temps plein)",
"Salarié du secteur public (précaire ou à temps partiel)",
"Indépendant sans salarié",
"Employeur",
"Chômeur",
"Inactif",
"Autre statut d'activité")
) 
    )) %>% 
  mutate(prof = factor(
    sdpcs7,
    levels=c(4,1,2,3,5,6,7),
    labels=paste0("-",c("Profession intermédiaire","Agriculteur",
                        "Artisan commerçant","Cadre supérieur, profession libérale",
                        "Employé","Ouvrier","Aucune"))
  ))  %>% 
  mutate(prof_statut_act = factor(
    sdpcs10,
    levels=c(4,1,2,3,5,6,7,8,9,10),
    labels=paste0("-",c("Profession intermédiaire","Agriculteur",
                        "Artisan commerçant","Cadre supérieur, profession libérale",
                        "Employé","Ouvrier","Chômeur",
                        "Retraité","Au foyer","Autre inactif"))
  )) %>%
  mutate(
    statut_activite_resp = factor(case_when(
      sdprstat==2 & (sdprsitua==1) ~ 1,
      sdprstat==2 & !(sdprsitua==1) ~ 2,
      sdprstat==1 & (sdprsitua==1) ~ 3,
      sdprstat==1 & !(sdprsitua==1) ~ 4,
      sdprstat==3 ~ 5,
      sdprstat==4 ~ 6,
      sdprstat==5 ~ 7,
      sdprstat==6 ~ 8,
      sdprstat==7 ~ 9,
      sdprstat==8 ~ NA_real_
   ),
    levels=1:9,
    labels=paste0("-Pers. réf. ",
                  c("Salarié du secteur privé (à temps plein)",
"Salarié du secteur privé (à temps partiel)",
"Salarié du secteur public (à temps plein)",
"Salarié du secteur public (à temps partiel)",
"Indépendant sans salarié",
"Employeur",
"Chômeur",
"Inactif",
"Autre statut d'activité")
) 
    )) %>% 
  mutate(prof_resp = factor(
    sdprpcs7,
    levels=c(4,1,2,3,5,6,7),
    labels=paste0("-Pers. réf. ",c("Profession intermédiaire","Agriculteur",
                        "Artisan commerçant","Cadre supérieur, profession libérale",
                        "Employé","Ouvrier","Aucune"))
  )) %>% 
  mutate(prof_statut_act_resp = factor(
    sdprpcs10,
    levels=c(4,1,2,3,5,6,7,8,9,10),
    labels=paste0("-Pers. réf. ",c("Profession intermédiaire","Agriculteur",
                        "Artisan commerçant","Cadre supérieur, profession libérale",
                        "Employé","Ouvrier","Chômeur",
                        "Retraité","Au foyer","Autre inactif"))
  ))

```

```{r, echo=FALSE}
run_regression <- function(x,y="subj_pauvrete",type_mod="logit", bdd_log=bdd_logit, kable=TRUE){

f <- as.formula(paste(y, paste0(x,collapse = " + "), sep="~"))

if(type_mod=="logit"){
  repetitions <- 1
  reg <- do.call("glm", list(formula=f,
                             data = bdd_log %>% dplyr::select(c(y,x)) %>% tidyr::drop_na(),
                             family=binomial(logit)))
 coeffs <- summary(reg)$coefficients[,1]
 p <- summary(reg)$coefficients[,4]
} else if (type_mod=="multinomial"){
repetitions <- length(levels(bdd_log[,y])[-1])
reg <- do.call("multinom", list(formula=f,
                             data = bdd_log %>% dplyr::select(c(y,x)) %>% tidyr::drop_na(), trace = FALSE))
  coeffs <- as.vector(t(summary(reg)$coefficients))
  z <- summary(reg)$coefficients/summary(reg)$standard.errors
  p <- as.vector((1 - pnorm(abs(t(z)), 0, 1)) * 2)
} else if (type_mod=="ordinal"){ #NEW
repetitions <- 1
reg <- do.call("polr", list(formula=f,
                             data = bdd_log %>% dplyr::select(c(y,x)) %>% tidyr::drop_na()))
  coeffs <- summary(reg)$coefficients[,1]
  p <- as.vector((1 - pnorm(abs(summary(reg)$coefficients[,3]), 0, 1)) * 2)
}


  if(type_mod!="ordinal"){
   modalites <- c("(Intercept)")
   noms <- c("-(Intercept)")
  } else{
   modalites <- NULL
   noms <- NULL
  }
   for(var in x){
     if(is.factor(bdd_log[,var])){
       modalites <- c(modalites,gsub("-","",levels(bdd_log[,var])))
       noms <- c(noms, paste0(var,levels(bdd_log[,var])[-1]))
     }else{
       modalites <- c(modalites,var)
       noms <- c(noms,paste0("-",var))
     }
   }
if(type_mod=="ordinal"){
   modalites <- c(modalites,names(coeffs)[grep("\\|",names(coeffs))])
   noms <- c(noms,paste0("(Intercept)-",names(coeffs)[grep("\\|",names(coeffs))]))
   
  }   
  
   
  df_model  <- data.frame(noms= noms,
                          valeur=round(coeffs,2),
                          pvaleur=cut(p, breaks = c(0, 0.001, 0.01, 0.05, 1),
                                      include.lowest = TRUE,
                                      labels = c('***', '**', '*', '')),
                          row.names=NULL
   ) %>% mutate(noms = gsub("`","",noms)) %>%  
     tidyr::separate(noms,c("variable","modalite"),sep="-") %>% 
   #  mutate(odds=ifelse(is.na(pvaleur) | pvaleur=='',NA,round(exp(coeffs),2))) %>%  
      mutate(odds=round(exp(coeffs),2)) %>% 
     mutate(modalite_y =
              if(type_mod!="multinomial"){NA}else{rep(levels(bdd_log[,y])[-1],each=n()/repetitions)}) %>% 
     right_join(
       data.frame(
         modalite_y=if(type_mod!="multinomial"){NA}else{rep(levels(bdd_log[,y])[-1],each=length(modalites))},
         modalite=rep(modalites,repetitions)
         )
       ,by=c("modalite_y","modalite")
       ) %>% 
     arrange(match(modalite_y,levels(bdd_log[,y])[-1]),match(modalite, modalites))
   
   if(type_mod == "logit"){
    R2_ajuste <- with(summary(reg), 1 - deviance/null.deviance)
    N <- length(summary(reg)$deviance.resid)
   } else {
     if(type_mod=="multinomial"){
        ref <- do.call("multinom",
                   list(formula=paste0(y," ~ ", 1),
                             data = bdd_log %>% dplyr::select(c(y,x)) %>% tidyr::drop_na(), trace = FALSE))
  
     } else if (type_mod=="ordinal"){
        ref <- do.call("polr",
                   list(formula=paste0(y," ~ ", 1),
                             data = bdd_log %>% dplyr::select(c(y,x)) %>% tidyr::drop_na()))
       
     }
     R2_ajuste <- nnet.mod.mfr2 <- as.numeric(1 -
                                  nnet:::logLik.multinom(reg) /
                                  nnet:::logLik.multinom(ref)
    )
    N <- length(summary(reg)$fitted.values[,1])
   } 
   
  if(y=="subj_pauvrete"){
    titre_y <- "Se déclarer pauvre"
  } else if(y=="subj_inf_mini_decla"){
    titre_y <- "Revenu inférieur au minimum déclaré"
  } else if(y=="subj_risque_pauvrete"){
    titre_y <- "Penser avoir un risque de devenir pauvre dans 5 ans"
  } else if(y=="subj_besoin_aide_etat"){
    titre_y <- "Considérer ne pas être suffisamment aidé par les pouvoirs publics"
  } else if(y=="subj_pauvrete_et_risque"){
    titre_y <- "Réponse à la question sur le risque de devenir pauvre ou non dans 5 ans (Non, Oui, Non je le suis déjà)"
  } else if(y=="latent_classes"){
    titre_y <- "Classes latentes du modèle"
  } else{
    titre_y <- "Non répondants selon la variable indiquée en y"
  }
    
  tableau <- df_model %>% dplyr::select(modalite_y,modalite,valeur,pvaleur,odds)
    
if(kable){
  tableau <- tableau %>% setNames(c("","Modalités","Coefficients","p-valeurs","Odds")) %>% 
            kable(format = 'latex', booktabs = TRUE, longtable = TRUE) %>%  
            kableExtra::column_spec(1, width = ifelse(type_mod=="multinomial","4cm","0cm")) %>% 
            kableExtra::column_spec(2, width = "4cm") %>% 
            kableExtra::column_spec(3:5, width = "2cm") %>% 
            kableExtra::kable_styling(latex_options = c("hold_position", "repeat_header")) %>% 
            kableExtra::footnote(c(paste0("Modèle logit (Variable dépendante = ",titre_y,")")), paste0("N = ",
                                        N," / R2 ajusté = ",
                                        round(100*R2_ajuste,1)," %")) 
}
    
  return(tableau)
}
```

## Pauvreté subjective {#pauvsub}

::::{.tcolorbox data-latex= } 
-	Les quintiles de niveau de vie ont un effet fort sur le sentiment de pauvreté. Quand on inclut uniquement ces variables dans le modèle, le pseudo-$R^2$ est de 16,4 %. Lorsqu’on y ajoute les revenus d’actifs financiers et de biens locatifs, il monte à 17,5 %.
-	Être bénéficiaire ou non des différentes prestations sociales permet d’obtenir un pseudo-$R^2$ de 11,9 %, ce qui est également important. La perception d’APL^[Bien que non considéré comme une vraie prestation sociale dans Duvoux et Papuchon.] joue un rôle important (pseudo-$R^2$ de 9,6 % pris tout seul), de même pour le RSA dans une moindre mesure. Sans variable de contrôle, la perception de ces prestations multiplie par 3 voire 4 les chances de se déclarer pauvre. 

\faArrowCircleRight{} Prises ensemble, pauvretés monétaire et institutionnelle ont un pseudo-$R^2$ de 20,1 %.

-	D’autres variables jouent un rôle important sur le fait de se déclarer pauvre, en particulier le fait d’être locataire, de vivre seul, d’être peu diplômé et de connaître parmi ses proches quelqu’un au RSA. 
-	En ajoutant toutes les variables de contrôle choisies ici, le pseudo-$R^2$ passe à 26,5 %. Les variables significatives sont la tranche d’âge 18-29 ans (+), l’inactivité sur le marché du travail hors chômeurs et retraités (+) et la PCS ouvrier (+). 
::::





### Quelques variables clefs prises une à une / groupe par groupe

Grosso modo dans leur ordre d'importance (du plus fort R2 ajusté au plus faible). 

```{r}
run_regression(x= c("quantile_nivie"), y="subj_pauvrete")
```

```{r}
run_regression(x= c("presta_rsa","presta_chomage","presta_fam","presta_apl","presta_handi","presta_etudes","presta_pensionalim"), y="subj_pauvrete")
```
    

```{r}
run_regression(x= c("presta_apl"), y="subj_pauvrete")
```

```{r}
run_regression(x= c("statut_occup"), y="subj_pauvrete")
```



```{r}
run_regression(x= c("prof_resp"), y="subj_pauvrete")
```


```{r}
run_regression(x= c("prof"), y="subj_pauvrete")
```

```{r}
run_regression(x= c("prof_statut_act"), y="subj_pauvrete")
```

```{r}
run_regression(x= c("prof_statut_act_resp"), y="subj_pauvrete")
```

```{r}
run_regression(x= c("revenus_salaires","revenus_independant","revenus_retraite","revenus_financiers","revenus_locatifs"), y="subj_pauvrete")
```

```{r}
run_regression(x= c("est_choindemnise", "est_chononindemnise","est_sdf","est_eleveseulsmic","est_pensionhandi","est_emploiprecaire","est_rsa","est_handijeune","est_dependant"), y="subj_pauvrete")
```

```{r}
run_regression(x= c("statact"), y="subj_pauvrete")
```

```{r}
run_regression(x= c("statut_activite"), y="subj_pauvrete")
```

```{r}
run_regression(x= c("statut_activite_resp"), y="subj_pauvrete")
```

```{r}
run_regression(x= c("diplome"), y="subj_pauvrete")
```


```{r}
run_regression(x= c("vie_fam"), y="subj_pauvrete")
```


```{r}
run_regression(x= c("presta_rsa"), y="subj_pauvrete")
```


```{r}
run_regression(x= c("conn_choindemnise", "conn_chononindemnise","conn_sdf","conn_eleveseulsmic","conn_pensionhandi","conn_emploiprecaire","conn_rsa","conn_handijeune","conn_dependant"), y="subj_pauvrete")
```

```{r}
run_regression(x= c("conn_choindemnise", "conn_chononindemnise","conn_sdf","conn_eleveseulsmic","conn_pensionhandi","conn_emploiprecaire","conn_rsa","conn_handijeune","conn_dependant"), y="subj_pauvrete")
```

```{r}
run_regression(x= c("annee_fac"), y="subj_pauvrete")
```

```{r}
run_regression(x= c("sexe"), y="subj_pauvrete")
```

### Modèles complets de régression

#### Monétaire

```{r}
run_regression(x= c("quantile_nivie","revenus_financiers","revenus_locatifs"), y="subj_pauvrete")
```

#### Monétaire + institutionnel

```{r}
run_regression(x= c("quantile_nivie","revenus_financiers","revenus_locatifs", "presta_rsa","presta_chomage","presta_apl","presta_handi"), y="subj_pauvrete")
```

#### Monétaire + institutionnel + précarité

```{r}
run_regression(x= c("quantile_nivie","revenus_financiers","revenus_locatifs", "presta_rsa","presta_chomage","presta_apl","presta_handi","statut_occup", "diplome", "vie_fam", "conn_rsa"), y="subj_pauvrete")
```

#### Monétaire + institutionnel + précarité + contrôles

```{r}
run_regression(y="subj_pauvrete", 
               x= c("quantile_nivie","revenus_financiers","revenus_locatifs", "presta_rsa","presta_chomage","presta_apl","presta_handi","statut_occup", "diplome", "conn_rsa","annee_fac", "prof_statut_act", "age_tranche","vie_fam", "sexe"
))
```


## Niveau de vie jugé inférieur au minimum pour vivre {#infminidecla}

::::{.tcolorbox data-latex= } 
-	Les quintiles de niveau de vie ont un effet encore plus prédictif que précédemment sur le fait d'avoir un niveau de vie jugé inférieur au minimum pour vivre. Quand on inclut uniquement ces variables dans le modèle, le pseudo-$R^2$ est de 25 %. C’est logique et provient d’un effet de structure, car les quintiles de niveau de vie permettent de construire en partie la variable à expliquer.

-	Être bénéficiaire ou non des différentes prestations sociales permet d’obtenir un pseudo-$R^2$ de 5,7 %, soit inférieur à précédemment (11,9 %). Ces variables ne sont même plus significatives dans le modèle complet avec variables de contrôle. 

-	Parmi les autres variables, cette fois-ci les variables sur la vie familiale ressortent davantage. Le fait de vivre seul a le même effet positif qu’avant mais cette fois-ci on a, étrangement, un effet négatif d’être chef d’une famille monoparentale ou enfant du foyer^[étrange, à expertiser ? Cela traduit-il le fait que la pauvreté monétaire pour des personnes vivant seule n’est pas bien traduite par le niveau de vie ? Ou le fait que les personnes dans ces situations jugent le niveau de vie minimum pour vivre plus bas que les autres ?].
::::


### Quelques variables clefs prises une à une / groupe par groupe

Grosso modo dans leur ordre d'importance (du plus fort R2 ajusté au plus faible)

```{r}
run_regression(x= c("quantile_nivie"), y="subj_inf_mini_decla")
```

```{r}
run_regression(x= c("presta_rsa","presta_chomage","presta_fam","presta_apl","presta_handi","presta_etudes","presta_pensionalim"), y="subj_inf_mini_decla")
```
    

```{r}
run_regression(x= c("presta_apl"), y="subj_inf_mini_decla")
```

```{r}
run_regression(x= c("statut_occup"), y="subj_inf_mini_decla")
```



```{r}
run_regression(x= c("prof_resp"), y="subj_inf_mini_decla")
```


```{r}
run_regression(x= c("prof"), y="subj_inf_mini_decla")
```

```{r}
run_regression(x= c("prof_statut_act"), y="subj_inf_mini_decla")
```

```{r}
run_regression(x= c("prof_statut_act_resp"), y="subj_inf_mini_decla")
```

```{r}
run_regression(x= c("revenus_salaires","revenus_independant","revenus_retraite","revenus_financiers","revenus_locatifs"), y="subj_inf_mini_decla")
```

```{r}
run_regression(x= c("est_choindemnise", "est_chononindemnise","est_sdf","est_eleveseulsmic","est_pensionhandi","est_emploiprecaire","est_rsa","est_handijeune","est_dependant"), y="subj_inf_mini_decla")
```

```{r}
run_regression(x= c("statact"), y="subj_inf_mini_decla")
```

```{r}
run_regression(x= c("statut_activite"), y="subj_inf_mini_decla")
```

```{r}
run_regression(x= c("statut_activite_resp"), y="subj_inf_mini_decla")
```

```{r}
run_regression(x= c("diplome"), y="subj_inf_mini_decla")
```


```{r}
run_regression(x= c("vie_fam"), y="subj_inf_mini_decla")
```


```{r}
run_regression(x= c("presta_rsa"), y="subj_inf_mini_decla")
```


```{r}
run_regression(x= c("conn_choindemnise", "conn_chononindemnise","conn_sdf","conn_eleveseulsmic","conn_pensionhandi","conn_emploiprecaire","conn_rsa","conn_handijeune","conn_dependant"), y="subj_inf_mini_decla")
```

```{r}
run_regression(x= c("conn_choindemnise", "conn_chononindemnise","conn_sdf","conn_eleveseulsmic","conn_pensionhandi","conn_emploiprecaire","conn_rsa","conn_handijeune","conn_dependant"), y="subj_inf_mini_decla")
```

```{r}
run_regression(x= c("annee_fac"), y="subj_inf_mini_decla")
```

```{r}
run_regression(x= c("sexe"), y="subj_inf_mini_decla")
```

### Modèles complets de régression

#### Monétaire

```{r}
run_regression(x= c("quantile_nivie","revenus_financiers","revenus_locatifs"), y="subj_inf_mini_decla")
```

#### Monétaire + institutionnel

```{r}
run_regression(x= c("quantile_nivie","revenus_financiers","revenus_locatifs", "presta_rsa","presta_chomage","presta_apl","presta_handi"), y="subj_inf_mini_decla")
```

#### Monétaire + institutionnel + précarité

```{r}
run_regression(x= c("quantile_nivie","revenus_financiers","revenus_locatifs", "presta_rsa","presta_chomage","presta_apl","presta_handi","statut_occup", "diplome", "vie_fam", "conn_rsa"), y="subj_inf_mini_decla")
```

#### Monétaire + institutionnel + précarité + contrôles

```{r}
run_regression(y="subj_inf_mini_decla", 
               x= c("quantile_nivie","revenus_financiers","revenus_locatifs", "presta_rsa","presta_chomage","presta_apl","presta_handi","statut_occup", "diplome", "conn_rsa","annee_fac", "prof_statut_act", "age_tranche","vie_fam", "sexe"
))
```

## Considérer ne pas être suffisamment aidé par les pouvoirs publics {#pouvpub}

::::{.tcolorbox data-latex= } 
-	Les quintiles de niveau de vie ont un effet plus faible que précédemment sur le fait d’être demandeur de davantage d’intervention publique. Quand on inclut uniquement ces variables dans le modèle, le pseudo-$R^2$ est de 14,3 %. 
-	Être bénéficiaire ou non des différentes prestations sociales permet d’obtenir un pseudo-$R^2$ de 6,6 %, soit inférieur à la pauvreté subjective (11,9 %) mais supérieur au niveau de vie jugé inférieur au minimum pour vivre (5,7%). Ces variables ne sont plus non plus significatives dans le modèle complet avec variables de contrôle. 
-	Parmi les autres variables, la structure familiale ressort une nouvelle fois. Cette fois-ci, être chef d’une famille monoparentale influe positivement et significativement dans tous les modèle sur le fait de considérer ne pas être suffisamment aidé par les pouvoirs publics. 
::::

### Quelques variables clefs prises une à une / groupe par groupe

Grosso modo dans leur ordre d'importance (du plus fort R2 ajusté au plus faible)

```{r}
run_regression(x= c("quantile_nivie"), y="subj_besoin_aide_etat")
```

```{r}
run_regression(x= c("presta_rsa","presta_chomage","presta_fam","presta_apl","presta_handi","presta_etudes","presta_pensionalim"), y="subj_besoin_aide_etat")
```
    

```{r}
run_regression(x= c("presta_apl"), y="subj_besoin_aide_etat")
```

```{r}
run_regression(x= c("statut_occup"), y="subj_besoin_aide_etat")
```



```{r}
run_regression(x= c("prof_resp"), y="subj_besoin_aide_etat")
```


```{r}
run_regression(x= c("prof"), y="subj_besoin_aide_etat")
```

```{r}
run_regression(x= c("prof_statut_act"), y="subj_besoin_aide_etat")
```

```{r}
run_regression(x= c("prof_statut_act_resp"), y="subj_besoin_aide_etat")
```

```{r}
run_regression(x= c("revenus_salaires","revenus_independant","revenus_retraite","revenus_financiers","revenus_locatifs"), y="subj_besoin_aide_etat")
```

```{r}
run_regression(x= c("est_choindemnise", "est_chononindemnise","est_sdf","est_eleveseulsmic","est_pensionhandi","est_emploiprecaire","est_rsa","est_handijeune","est_dependant"), y="subj_besoin_aide_etat")
```

```{r}
run_regression(x= c("statact"), y="subj_besoin_aide_etat")
```

```{r}
run_regression(x= c("statut_activite"), y="subj_besoin_aide_etat")
```

```{r}
run_regression(x= c("statut_activite_resp"), y="subj_besoin_aide_etat")
```

```{r}
run_regression(x= c("diplome"), y="subj_besoin_aide_etat")
```


```{r}
run_regression(x= c("vie_fam"), y="subj_besoin_aide_etat")
```


```{r}
run_regression(x= c("presta_rsa"), y="subj_besoin_aide_etat")
```


```{r}
run_regression(x= c("conn_choindemnise", "conn_chononindemnise","conn_sdf","conn_eleveseulsmic","conn_pensionhandi","conn_emploiprecaire","conn_rsa","conn_handijeune","conn_dependant"), y="subj_besoin_aide_etat")
```

```{r}
run_regression(x= c("conn_choindemnise", "conn_chononindemnise","conn_sdf","conn_eleveseulsmic","conn_pensionhandi","conn_emploiprecaire","conn_rsa","conn_handijeune","conn_dependant"), y="subj_besoin_aide_etat")
```

```{r}
run_regression(x= c("annee_fac_paires"), y="subj_besoin_aide_etat")
```

```{r}
run_regression(x= c("sexe"), y="subj_besoin_aide_etat")
```

### Modèles complets de régression

#### Monétaire

```{r}
run_regression(x= c("quantile_nivie","revenus_financiers","revenus_locatifs"), y="subj_besoin_aide_etat")
```

#### Monétaire + institutionnel

```{r}
run_regression(x= c("quantile_nivie","revenus_financiers","revenus_locatifs", "presta_rsa","presta_chomage","presta_apl","presta_handi"), y="subj_besoin_aide_etat")
```

#### Monétaire + institutionnel + précarité

```{r}
run_regression(x= c("quantile_nivie","revenus_financiers","revenus_locatifs", "presta_rsa","presta_chomage","presta_apl","presta_handi","statut_occup", "diplome", "vie_fam", "conn_rsa"), y="subj_besoin_aide_etat")
```

#### Monétaire + institutionnel + précarité + contrôles

```{r}
run_regression(y="subj_besoin_aide_etat", 
               x= c("quantile_nivie","revenus_financiers","revenus_locatifs", "presta_rsa","presta_chomage","presta_apl","presta_handi","statut_occup", "diplome", "conn_rsa","annee_fac_paires", "prof_statut_act", "age_tranche","vie_fam","sexe"
))
```

## Pauvreté ou Risque de pauvreté subjectifs (modèle multinomial) {#multinom}

### Quelques variables clefs prises une à une / groupe par groupe

Grosso modo dans leur ordre d'importance (du plus fort R2 ajusté au plus faible). 

```{r}
run_regression(x= c("quantile_nivie"), y="subj_pauvrete_et_risque", type_mod = "multinomial")
```

```{r}
run_regression(x= c("presta_rsa","presta_chomage","presta_fam","presta_apl","presta_handi","presta_etudes","presta_pensionalim"), y="subj_pauvrete_et_risque", type_mod = "multinomial")
```
    

```{r}
run_regression(x= c("presta_apl"), y="subj_pauvrete_et_risque", type_mod = "multinomial")
```

```{r}
run_regression(x= c("statut_occup"), y="subj_pauvrete_et_risque", type_mod = "multinomial")
```



```{r}
run_regression(x= c("prof_resp"), y="subj_pauvrete_et_risque", type_mod = "multinomial")
```


```{r}
run_regression(x= c("prof"), y="subj_pauvrete_et_risque", type_mod = "multinomial")
```

```{r}
run_regression(x= c("prof_statut_act"), y="subj_pauvrete_et_risque", type_mod = "multinomial")
```

```{r}
run_regression(x= c("prof_statut_act_resp"), y="subj_pauvrete_et_risque", type_mod = "multinomial")
```

```{r}
run_regression(x= c("revenus_salaires","revenus_independant","revenus_retraite","revenus_financiers","revenus_locatifs"), y="subj_pauvrete_et_risque", type_mod = "multinomial")
```

```{r}
run_regression(x= c("est_choindemnise", "est_chononindemnise","est_sdf","est_eleveseulsmic","est_pensionhandi","est_emploiprecaire","est_rsa","est_handijeune","est_dependant"), y="subj_pauvrete_et_risque", type_mod = "multinomial")
```

```{r}
run_regression(x= c("statact"), y="subj_pauvrete_et_risque", type_mod = "multinomial")
```

```{r}
run_regression(x= c("statut_activite"), y="subj_pauvrete_et_risque", type_mod = "multinomial")
```

```{r}
run_regression(x= c("statut_activite_resp"), y="subj_pauvrete_et_risque", type_mod = "multinomial")
```

```{r}
run_regression(x= c("diplome"), y="subj_pauvrete_et_risque", type_mod = "multinomial")
```


```{r}
run_regression(x= c("vie_fam"), y="subj_pauvrete_et_risque", type_mod = "multinomial")
```


```{r}
run_regression(x= c("presta_rsa"), y="subj_pauvrete_et_risque", type_mod = "multinomial")
```


```{r}
run_regression(x= c("conn_choindemnise", "conn_chononindemnise","conn_sdf","conn_eleveseulsmic","conn_pensionhandi","conn_emploiprecaire","conn_rsa","conn_handijeune","conn_dependant"), y="subj_pauvrete_et_risque", type_mod = "multinomial")
```

```{r}
run_regression(x= c("conn_choindemnise", "conn_chononindemnise","conn_sdf","conn_eleveseulsmic","conn_pensionhandi","conn_emploiprecaire","conn_rsa","conn_handijeune","conn_dependant"), y="subj_pauvrete_et_risque", type_mod = "multinomial")
```

```{r}
run_regression(x= c("annee_fac"), y="subj_pauvrete_et_risque", type_mod = "multinomial")
```

```{r}
run_regression(x= c("sexe"), y="subj_pauvrete_et_risque", type_mod = "multinomial")
```

### Modèles complets de régression

#### Monétaire

```{r}
run_regression(x= c("quantile_nivie","revenus_financiers","revenus_locatifs"), y="subj_pauvrete_et_risque", type_mod = "multinomial")
```

#### Monétaire + institutionnel

```{r}
run_regression(x= c("quantile_nivie","revenus_financiers","revenus_locatifs", "presta_rsa","presta_chomage","presta_apl","presta_handi"), y="subj_pauvrete_et_risque", type_mod = "multinomial")
```

#### Monétaire + institutionnel + précarité

```{r}
run_regression(x= c("quantile_nivie","revenus_financiers","revenus_locatifs", "presta_rsa","presta_chomage","presta_apl","presta_handi","statut_occup", "diplome", "vie_fam", "conn_rsa"), y="subj_pauvrete_et_risque", type_mod = "multinomial")
```

#### Monétaire + institutionnel + précarité + contrôles

```{r}
run_regression(y="subj_pauvrete_et_risque", type_mod = "multinomial", 
               x= c("quantile_nivie","revenus_financiers","revenus_locatifs", "presta_rsa","presta_chomage","presta_apl","presta_handi","statut_occup", "diplome", "conn_rsa","annee_fac", "prof_statut_act", "age_tranche","vie_fam", "sexe"
))
```





## Pauvreté ou Risque de pauvreté subjectifs (modèle ordinal) **[NEW]** {#ordinal}

### Quelques variables clefs prises une à une / groupe par groupe

Grosso modo dans leur ordre d'importance (du plus fort R2 ajusté au plus faible). 

```{r}
run_regression(x= c("quantile_nivie"), y="subj_pauvrete_et_risque", type_mod = "ordinal")
```

```{r}
run_regression(x= c("presta_rsa","presta_chomage","presta_fam","presta_apl","presta_handi","presta_etudes","presta_pensionalim"), y="subj_pauvrete_et_risque", type_mod = "ordinal")
```
    

```{r}
run_regression(x= c("presta_apl"), y="subj_pauvrete_et_risque", type_mod = "ordinal")
```

```{r}
run_regression(x= c("statut_occup"), y="subj_pauvrete_et_risque", type_mod = "ordinal")
```



```{r}
run_regression(x= c("prof_resp"), y="subj_pauvrete_et_risque", type_mod = "ordinal")
```


```{r}
run_regression(x= c("prof"), y="subj_pauvrete_et_risque", type_mod = "ordinal")
```

```{r}
run_regression(x= c("prof_statut_act"), y="subj_pauvrete_et_risque", type_mod = "ordinal")
```

```{r}
run_regression(x= c("prof_statut_act_resp"), y="subj_pauvrete_et_risque", type_mod = "ordinal")
```

```{r}
run_regression(x= c("revenus_salaires","revenus_independant","revenus_retraite","revenus_financiers","revenus_locatifs"), y="subj_pauvrete_et_risque", type_mod = "ordinal")
```

```{r}
run_regression(x= c("est_choindemnise", "est_chononindemnise","est_sdf","est_eleveseulsmic","est_pensionhandi","est_emploiprecaire","est_rsa","est_handijeune","est_dependant"), y="subj_pauvrete_et_risque", type_mod = "ordinal")
```

```{r}
run_regression(x= c("statact"), y="subj_pauvrete_et_risque", type_mod = "ordinal")
```

```{r}
run_regression(x= c("statut_activite"), y="subj_pauvrete_et_risque", type_mod = "ordinal")
```

```{r}
run_regression(x= c("statut_activite_resp"), y="subj_pauvrete_et_risque", type_mod = "ordinal")
```

```{r}
run_regression(x= c("diplome"), y="subj_pauvrete_et_risque", type_mod = "ordinal")
```


```{r}
run_regression(x= c("vie_fam"), y="subj_pauvrete_et_risque", type_mod = "ordinal")
```


```{r}
run_regression(x= c("presta_rsa"), y="subj_pauvrete_et_risque", type_mod = "ordinal")
```


```{r}
run_regression(x= c("conn_choindemnise", "conn_chononindemnise","conn_sdf","conn_eleveseulsmic","conn_pensionhandi","conn_emploiprecaire","conn_rsa","conn_handijeune","conn_dependant"), y="subj_pauvrete_et_risque", type_mod = "ordinal")
```

```{r}
run_regression(x= c("conn_choindemnise", "conn_chononindemnise","conn_sdf","conn_eleveseulsmic","conn_pensionhandi","conn_emploiprecaire","conn_rsa","conn_handijeune","conn_dependant"), y="subj_pauvrete_et_risque", type_mod = "ordinal")
```

```{r}
run_regression(x= c("annee_fac"), y="subj_pauvrete_et_risque", type_mod = "ordinal")
```

```{r}
run_regression(x= c("sexe"), y="subj_pauvrete_et_risque", type_mod = "ordinal")
```

### Modèles complets de régression

#### Monétaire

```{r}
run_regression(x= c("quantile_nivie","revenus_financiers","revenus_locatifs"), y="subj_pauvrete_et_risque", type_mod = "ordinal")
```

#### Monétaire + institutionnel

```{r}
run_regression(x= c("quantile_nivie","revenus_financiers","revenus_locatifs", "presta_rsa","presta_chomage","presta_apl","presta_handi"), y="subj_pauvrete_et_risque", type_mod = "ordinal")
```

#### Monétaire + institutionnel + précarité

```{r}
run_regression(x= c("quantile_nivie","revenus_financiers","revenus_locatifs", "presta_rsa","presta_chomage","presta_apl","presta_handi","statut_occup", "diplome", "vie_fam", "conn_rsa"), y="subj_pauvrete_et_risque", type_mod = "ordinal")
```

#### Monétaire + institutionnel + précarité + contrôles

```{r}
run_regression(y="subj_pauvrete_et_risque", type_mod = "ordinal", 
               x= c("quantile_nivie","revenus_financiers","revenus_locatifs", "presta_rsa","presta_chomage","presta_apl","presta_handi","statut_occup", "diplome", "conn_rsa","annee_fac", "prof_statut_act", "age_tranche","vie_fam", "sexe"
))
```

## Caractéristiques des valeurs manquantes


::::{.tcolorbox data-latex= } 
Les valeurs manquantes concernent en particulier 4 variables : 

1. Le **niveau de vie** (phénomène très important)

Comme classiquement s'agissant du niveau de revenu, les non-réponses concernent en particulier les personnes aisées^[variables qui ressortent significatives : ne pas recevoir d'APL, ne pas être locataire de HLM, ne pas être peu diplômé, ne pas connaître quelqu'un au RSA], celles qui ne vivent pas seules, et les enfants des familles quand ce sont les répondants. 

2. Le **risque ou sentiment de pauvreté** (phénomène assez important)

A l'inverse du niveau de vie objectif, les non-répondants au sentiment de pauvreté sont des populations plus populaires^[deux variables ressortent : ne pas être propriétaire et ne pas être diplômé d'au-dessus d'un bac+3]

3. Le **minimum déclaré pour vivre** (phénomène assez important). 

Le fait de ne pas connaître quelqu'un au RSA, d'être l'enfant de la famille et d'être artisan / commerçant augmente les chances de non-réponse à cette question. Il est à noter que pour la variable `subj_inf_mini_decla` la non-réponse du minimum déclaré pour vivre se cumule avec celle du niveau de vie (décrit ci-dessus). 

4. Le **niveau de diplôme** (phénomène peu important)

Le phénomène de non-réponse est apparemment trop peu pregnant pour que certaines variables ressortent significatives.

::::
```{r, echo=FALSE}
gg_miss_var(
bdd_logit %>% 
   mutate(pe16 = ifelse(pe16==999999999,NA,pe16)) %>% 
  dplyr::select( 
c("pe16", "subj_pauvrete_et_risque","quantile_nivie","revenus_financiers","revenus_locatifs", "presta_rsa","presta_chomage","presta_apl","presta_handi","statut_occup", "diplome", "conn_rsa","annee_fac", "prof_statut_act", "age_tranche","vie_fam", "sexe")
)
)
```

```{r, echo=FALSE}
bdd_vm <- bdd_logit %>% 
  mutate(pe16 = ifelse(pe16==999999999,NA,pe16)) %>% 
  dplyr::select( 
c("subj_pauvrete_et_risque","pe16","quantile_nivie","revenus_financiers","revenus_locatifs", "presta_rsa","presta_chomage","presta_apl","presta_handi","statut_occup", "diplome", "conn_rsa","annee_fac", "prof_statut_act", "age_tranche","vie_fam", "sexe")
) %>%
  mutate(non_rep_minidecla=factor(ifelse(is.na(pe16),1,0)),
         non_rep_nivie=factor(ifelse(is.na(quantile_nivie),1,0)),
         non_rep_subjpauv=factor(ifelse(is.na(subj_pauvrete_et_risque),1,0)),
         non_rep_dipl=factor(ifelse(is.na(diplome),1,0)),
         non_rep=factor(ifelse(is.na(subj_pauvrete_et_risque) |
                               is.na(pe16) |                                                           is.na(quantile_nivie) |
                               is.na(revenus_financiers) |
                               is.na(revenus_locatifs) |
                               is.na(presta_rsa) |
                               is.na(presta_chomage) |
                               is.na(presta_apl) |
                               is.na(presta_handi) |
                               is.na(statut_occup) |
                               is.na(diplome) |
                               is.na(conn_rsa) |
                               is.na(annee_fac) |
                               is.na(prof_statut_act) |
                               is.na(age_tranche) |
                               is.na(vie_fam) |
                               is.na(sexe) 
                                 ,
                        1,0))
         ) %>% 
  mutate(
  pe16 = factor(replace_na(as.numeric(pe16),99),labels=c(levels(bdd_logit$pe16), paste0("NSP"," mini_decla"))), 
  subj_pauvrete_et_risque = factor(replace_na(as.numeric(subj_pauvrete_et_risque),99),labels=c(levels(bdd_logit$subj_pauvrete_et_risque), paste0("NSP"," subj_pauvrete_et_risque"))), 
  quantile_nivie = factor(replace_na(as.numeric(quantile_nivie),99),labels=c(levels(bdd_logit$quantile_nivie), paste0("NSP"," quantile_nivie"))), 
  revenus_financiers = factor(replace_na(as.numeric(revenus_financiers),99),labels=c(levels(bdd_logit$revenus_financiers), paste0("NSP"," revenus_fin"))), 
  revenus_locatifs = factor(replace_na(as.numeric(revenus_locatifs),99),labels=c(levels(bdd_logit$revenus_locatifs), paste0("NSP"," revenus_loc"))), 
  presta_rsa = factor(replace_na(as.numeric(presta_rsa),99),labels=c(levels(bdd_logit$presta_rsa), paste0("NSP"," presta_rsa"))), 
    presta_chomage = factor(replace_na(as.numeric(presta_chomage),99),labels=c(levels(bdd_logit$presta_chomage), paste0("NSP"," presta_cho"))), 
  presta_apl = factor(replace_na(as.numeric(presta_apl),99),labels=c(levels(bdd_logit$presta_apl), paste0("NSP"," presta_apl"))), 
  presta_handi = factor(replace_na(as.numeric(presta_handi),99),labels=c(levels(bdd_logit$presta_handi), paste0("NSP"," presta_handi"))), 
  statut_occup = factor(replace_na(as.numeric(statut_occup),99),labels=c(levels(bdd_logit$statut_occup), paste0("NSP"," statut_occup"))), 
  conn_rsa = factor(replace_na(as.numeric(conn_rsa),99),labels=c(levels(bdd_logit$conn_rsa), paste0("NSP"," conn_rsa")))#, 
  # annee_fac = factor(replace_na(as.numeric(annee_fac),99),labels=c(levels(bdd_logit$annee_fac), "NSP")), 
  # prof_statut_act = factor(replace_na(as.numeric(prof_statut_act),99),labels=c(levels(bdd_logit$prof_statut_act), "NSP")), 
  # age_tranche = factor(replace_na(as.numeric(age_tranche),99),labels=c(levels(bdd_logit$age_tranche), "NSP")), 
    # vie_fam = factor(replace_na(as.numeric(vie_fam),99),labels=c(levels(bdd_logit$vie_fam), "NSP")), 
  # sexe = factor(replace_na(as.numeric(sexe),99),labels=c(levels(bdd_logit$sexe), "NSP"))
  ) 
```

```{r}
run_regression(y="non_rep_nivie", 
               x= c("subj_pauvrete_et_risque","revenus_financiers","revenus_locatifs","presta_rsa","presta_chomage","presta_apl","presta_handi","statut_occup", "diplome", "conn_rsa","annee_fac", "prof_statut_act", "age_tranche","vie_fam", "sexe" #"subj_pauvrete_et_risque",
               ),
               bdd_log=bdd_vm)

run_regression(y="non_rep_subjpauv", 
               x= c("quantile_nivie","revenus_financiers","revenus_locatifs","presta_rsa","presta_chomage","presta_apl","presta_handi","statut_occup", "diplome", "conn_rsa","annee_fac", "prof_statut_act", "age_tranche","vie_fam", "sexe" #"subj_pauvrete_et_risque",
               ),
               bdd_log=bdd_vm)

run_regression(y="non_rep_minidecla", 
               x= c("subj_pauvrete_et_risque","revenus_financiers","revenus_locatifs","presta_rsa","presta_chomage","presta_apl","presta_handi","statut_occup", "diplome", "conn_rsa","annee_fac", "prof_statut_act", "age_tranche","vie_fam", "sexe" #"subj_pauvrete_et_risque",
               ),
               bdd_log=bdd_vm)

run_regression(y="non_rep_dipl", 
               x= c("quantile_nivie","subj_pauvrete_et_risque","revenus_financiers","revenus_locatifs","presta_rsa","presta_chomage","presta_apl","presta_handi","statut_occup", "conn_rsa","annee_fac", "prof_statut_act", "age_tranche","vie_fam", "sexe"
               ),
               bdd_log=bdd_vm)
```




## Figures rapport 

RSA : individu / ménage

```{r, echo=FALSE}
# run_regression(y="subj_pauvrete", 
#                        x= c("est_rsa","vie_fam"),
#                kable=TRUE)
#14613 8%
# run_regression(y="subj_pauvrete", 
#                x= c("presta_rsa","vie_fam"),
#                kable=TRUE)
#14634 8,3%

tab_rsa1 <- bind_cols(
  run_regression(y="subj_pauvrete", 
                       x= c("est_rsa","vie_fam"),
               kable=FALSE)  %>%
  mutate(odds_ratio = ifelse(
    !is.na(valeur),paste0(gsub("\\.",",",odds),pvaleur),"Réf."
  )) %>% 
  dplyr::select(modalite,odds_ratio) %>% 
  slice(-1) %>%
  mutate(modalite = c("Pas de RSA", "RSA", modalite[3:8])
         ) %>% 
  arrange(match(modalite, c(modalite[1:2],modalite[4],modalite[3],modalite[5],modalite[6:8]))),
  
  run_regression(y="subj_pauvrete", 
                       x= c("presta_rsa","vie_fam"),
               kable=FALSE)  %>%
  mutate(odds_ratio = ifelse(
    !is.na(valeur),paste0(gsub("\\.",",",odds),pvaleur),"Réf."
  )) %>% 
  dplyr::select(modalite,odds_ratio) %>% 
  slice(-1) %>%
  mutate(modalite = c("N'a personne dans son ménage au RSA", "A quelqu'un dans son ménage au RSA", modalite[3:8])
         ) %>% 
      arrange(match(modalite, c(modalite[1:2],modalite[4],modalite[3],modalite[5],modalite[6:8])))
  %>% pull(odds_ratio)
) %>% 
  setNames(c("Modèle logit. Variable dépendante : se déclarer pauvre", "Odds ratio (individu)","Odds ratio (ménage)")) 

saveRDS(tab_rsa1,"../rapport/figures/tab_rsa1.RDS")

tab_rsa1 %>% 
  kable(caption="Mesure de l'effet d'être bénéficiaire du RSA à différents niveaux (individu, ménage) sur le sentiment de pauvreté", booktabs = TRUE, longtable = FALSE) %>%  
  kableExtra::column_spec(1, width = "6cm") %>% 
  kableExtra::column_spec(2, width = "2cm") %>%
  kableExtra::footnote(c(paste0("Niveau individu : N = ",
                                 "14613"," et $R^2$ ajusté = ","8,0"," %",
                                 " / Niveau ménage : N = ",
                                 "14634"," et $R^2$ ajusté = ",
                              "8,3"," %."),"* : significatif au seuil de 5 % ; ** : 1 % ; *** : 0,1 %."
                         )) %>% 
  kableExtra::kable_paper("striped", full_width = F) %>%
  kableExtra::pack_rows("Perception du RSA", 1, 2) %>%
  kableExtra::pack_rows("Structure familiale (contrôle)",3,8) 
  
```

RSA : individu / famille / hors famille

```{r, echo=FALSE}
# run_regression(y="subj_pauvrete", 
#                        x= c("est_rsa","conn_rsa_fam",
#                     "conn_rsa_horsfam","vie_fam"),
#                kable=TRUE)


tab_rsa2 <- run_regression(y="subj_pauvrete", 
                       x= c("est_rsa","conn_rsa_fam",
                    "conn_rsa_horsfam","vie_fam"),
               kable=FALSE)  %>%
  mutate(odds_ratio = ifelse(
    !is.na(valeur),paste0(gsub("\\.",",",odds),pvaleur),"Réf."
  )) %>% 
  dplyr::select(modalite,odds_ratio) %>% 
  slice(-1) %>%
  mutate(modalite = c("N'est pas une personne au RSA", "Est une personne au RSA", "Ne connaît personne dans sa famille au RSA", "Connaît quelqu'un dans sa famille au RSA", "Ne connaît personne hors famille au RSA", "Connaît quelqu'un hors famille au RSA", modalite[7:12])
         ) %>% 
  arrange(match(modalite, c(modalite[1:6],modalite[8],modalite[7],modalite[9:12]))) %>% 
  setNames(c("Modèle logit. Variable dépendante : se déclarer pauvre", "Odds ratio")) 

saveRDS(tab_rsa2,"../rapport/figures/tab_rsa2.RDS")


tab_rsa2 %>% 
  kable(caption="Mesure de l'effet d'être bénéficiaire du RSA à différents niveaux (individu, famille et hors famille) sur le sentiment de pauvreté", booktabs = TRUE, longtable = FALSE) %>%  
  kableExtra::column_spec(1, width = "6cm") %>% 
  kableExtra::column_spec(2, width = "2cm") %>%
  kableExtra::footnote(c(paste0("N = ",
                              "14613"," et $R^2$ ajusté = ",
                              "9,1"," %."), 
                         "* : significatif au seuil de 5 % ; ** : 1 % ; *** : 0,1 %.")
                         ) %>% 
  kableExtra::kable_paper("striped", full_width = F) %>%
  kableExtra::pack_rows("Individu", 1, 2) %>%
  kableExtra::pack_rows("Famille", 3, 4) %>% 
  kableExtra::pack_rows("Hors famille", 5, 6) %>% 
  kableExtra::pack_rows("Structure familiale (contrôle)",7,12) 
  
```


Pauvreté monétaire

```{r, echo=FALSE}
# run_regression(x= c("quantile_nivie", "revenus_salaires","revenus_independant","revenus_retraite","revenus_financiers","revenus_locatifs","vie_fam"), y="subj_pauvrete",kable=TRUE)

tab_mon <- run_regression(x= c("quantile_nivie", "revenus_salaires","revenus_independant","revenus_retraite","revenus_financiers","revenus_locatifs","vie_fam"), y="subj_pauvrete",kable=FALSE) %>% 
  mutate(odds_ratio = ifelse(
    !is.na(valeur),paste0(gsub("\\.",",",odds),pvaleur),"Réf."
  )) %>% 
  select(modalite,odds_ratio) %>% 
  slice(-1) %>% 
  arrange(match(modalite, c(modalite[2],modalite[-2]))) %>% 
    arrange(match(modalite, c(modalite[1:15],modalite[17],modalite[16],modalite[18:21]))) %>% 
 setNames(c("Modèle logit. Variable dépendante : se déclarer pauvre", "Odds ratio")) 

saveRDS(tab_mon,"../rapport/figures/tab_mon.RDS")


tab_mon %>% 
  kable(caption="Mesure de l'effet de la pauvreté monétaire sur le sentiment de pauvreté", booktabs = TRUE, longtable = FALSE) %>%  
  kableExtra::column_spec(1, width = "6cm") %>% 
  kableExtra::column_spec(2, width = "2cm") %>%
  kableExtra::footnote(c(paste0("N = ",
                              "13672"," et $R^2$ ajusté = ",
                              "20,0"," %."), 
                         "* : significatif au seuil de 5 % ; ** : 1 % ; *** : 0,1 %.")
                         )  %>% 
  kableExtra::kable_paper("striped", full_width = F) %>%
  kableExtra::pack_rows("Pauvreté monétaire", 1, 5) %>%
  kableExtra::pack_rows("Structure familiale (contrôle)",16,21) 
```

Pauvreté institutionnelle

```{r, echo=FALSE}
# run_regression(x= c("presta_rsa","presta_chomage","presta_apl","presta_handi","presta_etudes", "presta_hlm","vie_fam"), y="subj_pauvrete",kable=TRUE)

tab_inst <- run_regression(x= c("presta_rsa","presta_chomage","presta_apl","presta_handi","presta_etudes", "presta_hlm","vie_fam"), y="subj_pauvrete",kable=FALSE) %>% 
  mutate(odds_ratio = ifelse(
    !is.na(valeur),paste0(gsub("\\.",",",odds),pvaleur),"Réf."
  )) %>% 
  select(modalite,odds_ratio) %>% 
  slice(-1) %>%
     arrange(match(modalite, c(modalite[1:12],modalite[14],modalite[13],modalite[15:18]))) %>% 
 setNames(c("Modèle logit. Variable dépendante : se déclarer pauvre", "Odds ratio")) 

saveRDS(tab_inst,"../rapport/figures/tab_inst.RDS")


tab_inst %>% 
  kable(caption="Mesure de l'effet de la pauvreté institutionnelle sur le sentiment de pauvreté", booktabs = TRUE, longtable = FALSE) %>%  
  kableExtra::column_spec(1, width = "6cm") %>% 
  kableExtra::column_spec(2, width = "2cm") %>%
  kableExtra::footnote(c(paste0("N = ",
                              "14613"," et $R^2$ ajusté = ",
                              "14,8"," %."), 
                         "* : significatif au seuil de 5 % ; ** : 1 % ; *** : 0,1 %.")
                         ) %>% 
  kableExtra::pack_rows("Pauvreté institutionnelle", 1, 5) %>%
  kableExtra::pack_rows("Structure familiale (contrôle)",13,18) 

```

 
```{r, echo=FALSE}
# run_regression(y="subj_pauvrete",
#                x= c("quantile_nivie","revenus_locatifs","revenus_financiers","presta_rsa","presta_apl","presta_chomage","presta_handi","statut_occup", "prof_statut_act","est_emploiprecaire", "diplome", "age_tranche","vie_fam", "sexe", "conn_rsa", "annee_fac"
# ), kable = TRUE)

tab_final21_sentpauv <- run_regression(y="subj_pauvrete", 
               x= c("quantile_nivie","revenus_locatifs","revenus_financiers","presta_rsa","presta_apl","presta_chomage","presta_handi","statut_occup", "prof_statut_act","est_emploiprecaire", "diplome", "age_tranche","vie_fam", "sexe", "conn_rsa", "annee_fac"
), kable = FALSE) %>% 
  mutate(odds_ratio = ifelse(
    !is.na(valeur),paste0(gsub("\\.",",",odds),pvaleur),"Réf."
  )) %>% 
  dplyr::select(modalite_y,modalite,odds_ratio) %>% 
  slice(-1) %>% 
  arrange(match(modalite, c(modalite[2],modalite[-2]))) %>% 
  arrange(match(modalite, c(modalite[1:17],modalite[19],modalite[18],modalite[20:57]))) %>% 
  arrange(match(modalite, c(modalite[1:20],modalite[22:24],modalite[21],modalite[25:57])))  %>% 
  arrange(match(modalite, c(modalite[1:32],modalite[34],modalite[33],modalite[35:57]))) %>% 
  arrange(match(modalite, c(modalite[1:36],modalite[38],modalite[37],modalite[39:57]))) %>% 
  arrange(match(modalite, c(modalite[1:42],modalite[44],modalite[43],modalite[45:57]))) %>% 
  mutate(modalite_y = c("Niveau de vie",rep("",4),"Types de ressources ","perçues par le ménage ","(12 mois)",rep("",9),"Logement",rep("",2), "Situation professionnelle",rep("",9),"Précarité de l'emploi","(subjective)","Niveau de diplôme le plus élevé",rep("",3), "Classe d'âge",rep("",5),"Situation familiale",rep("",5),"Sexe",rep("",1),"Entourage au RSA",rep("",1),"Année",rep("",4))) %>% setNames(c("Modèle logit", "Variable dépendante : se déclarer pauvre", "Odds ratio")) 

# tab_final21_sentpauv %>% 
#   kable(caption="Modèle de synthèse des effets sur le sentiment de pauvreté", booktabs = TRUE, longtable = TRUE) %>%  
#    kableExtra::column_spec(1, width = "4cm") %>%
#    kableExtra::column_spec(2, width = "6cm") %>%
#    kableExtra::column_spec(3, width = "4cm") %>%
#   kableExtra::kable_styling(
#   latex_options = c("hold_position", "repeat_header"),
#   repeat_header_text = "\\textit{(suite)}",
#   repeat_header_continued = "\\textit{(suite en page suivante...)}"
#   ) %>%
#   kableExtra::pack_rows("Pauvreté monétaire", 1, 9) %>%
#   kableExtra::pack_rows("Pauvreté institutionnelle", 10, 18) %>%
#   kableExtra::pack_rows("Contrôles", 19, 56) %>%
#   kableExtra::footnote(c(paste0("N = ",
#                               "13548"," et $R^2$ ajusté = ",
#                               "26,0"," %."), 
#                          "* : significatif au seuil de 5 % ; ** : 1 % ; *** : 0,1 %.")
#                          ) 

# run_regression(y="subj_inf_mini_decla",
#                x= c("quantile_nivie","revenus_locatifs","revenus_financiers","presta_rsa","presta_apl","presta_chomage","presta_handi","statut_occup", "prof_statut_act","est_emploiprecaire", "diplome", "age_tranche","vie_fam", "sexe", "conn_rsa", "annee_fac"
# ), kable = TRUE)

tab_final21_infminidecla <- run_regression(y="subj_inf_mini_decla", 
               x= c("quantile_nivie","revenus_locatifs","revenus_financiers","presta_rsa","presta_apl","presta_chomage","presta_handi","statut_occup", "prof_statut_act","est_emploiprecaire", "diplome", "age_tranche","vie_fam", "sexe", "conn_rsa", "annee_fac"
), kable = FALSE) %>% 
  mutate(odds_ratio = ifelse(
    !is.na(valeur),paste0(gsub("\\.",",",odds),pvaleur),"Réf."
  )) %>% 
  dplyr::select(modalite_y,modalite,odds_ratio) %>% 
  slice(-1) %>% 
  arrange(match(modalite, c(modalite[2],modalite[-2]))) %>% 
  arrange(match(modalite, c(modalite[1:17],modalite[19],modalite[18],modalite[20:57]))) %>% 
  arrange(match(modalite, c(modalite[1:20],modalite[22:24],modalite[21],modalite[25:57])))  %>% 
  arrange(match(modalite, c(modalite[1:32],modalite[34],modalite[33],modalite[35:57]))) %>% 
  arrange(match(modalite, c(modalite[1:36],modalite[38],modalite[37],modalite[39:57]))) %>% 
  arrange(match(modalite, c(modalite[1:42],modalite[44],modalite[43],modalite[45:57]))) %>% 
  mutate(modalite_y = c("Niveau de vie",rep("",4),"Types de ressources ","perçues par le ménage ","(12 mois)",rep("",9),"Logement",rep("",2), "Situation professionnelle",rep("",9),"Précarité de l'emploi","(subjective)","Niveau de diplôme le plus élevé",rep("",3), "Classe d'âge",rep("",5),"Situation familiale",rep("",5),"Sexe",rep("",1),"Entourage au RSA",rep("",1),"Année",rep("",4))) %>% setNames(c("Modèle logit", "Variable dépendante : se déclarer pauvre", "Odds ratio")) 

# tab_final21_infminidecla %>% 
#   kable(caption="Modèle de synthèse des effets sur le sentiment de pauvreté", booktabs = TRUE, longtable = TRUE) %>%  
#    kableExtra::column_spec(1, width = "4cm") %>%
#    kableExtra::column_spec(2, width = "6cm") %>%
#    kableExtra::column_spec(3, width = "4cm") %>%
#   kableExtra::kable_styling(
#   latex_options = c("hold_position", "repeat_header"),
#   repeat_header_text = "\\textit{(suite)}",
#   repeat_header_continued = "\\textit{(suite en page suivante...)}"
#   ) %>%
#   kableExtra::pack_rows("Pauvreté monétaire", 1, 9) %>%
#   kableExtra::pack_rows("Pauvreté institutionnelle", 10, 18) %>%
#   kableExtra::pack_rows("Contrôles", 19, 56) %>%
#   kableExtra::footnote(c(paste0("N = ",
#                               "13678"," et $R^2$ ajusté = ",
#                               "28,6"," %."), 
#                          "* : significatif au seuil de 5 % ; ** : 1 % ; *** : 0,1 %.")
#                          ) 



```

```{r, echo=FALSE}
tab_final21 <- tab_final21_sentpauv %>% bind_cols(tab_final21_infminidecla %>% dplyr::select(`Odds ratio`)) %>% 
  setNames(c("Modèle logit","Odds ratio. Variables dépendantes :", "Se déclarer pauvre","Avoir un revenu inférieur au minimum déclaré"))

saveRDS(tab_final21,"../rapport/figures/tab_final21.RDS")

tab_final21 %>%
  kable(caption="Modèle de synthèse des effets sur le sentiment de pauvreté et les difficultés financières perçues", booktabs = TRUE, longtable = TRUE) %>%
   kableExtra::column_spec(1, width = "4cm") %>%
   kableExtra::column_spec(2, width = "6cm") %>%
   kableExtra::column_spec(3:4, width = "4cm") %>%
  kableExtra::kable_styling(
  latex_options = c("hold_position", "repeat_header"),
  repeat_header_text = "\\textit{(suite)}",
  repeat_header_continued = "\\textit{(suite en page suivante...)}"
  ) %>%
  kableExtra::pack_rows("Pauvreté monétaire", 1, 9) %>%
  kableExtra::pack_rows("Pauvreté institutionnelle", 10, 18) %>%
  kableExtra::pack_rows("Contrôles", 19, 57) %>%
  kableExtra::footnote(c(paste0("Sentiment de pauvreté : N = ",
                                 "13548"," et $R^2$ ajusté = ","26,0"," %",
                                 " / Difficultés financières perçues : N = ",
                                 "13678"," et $R^2$ ajusté = ",
                              "28,6"," %."),"* : significatif au seuil de 5 % ; ** : 1 % ; *** : 0,1 %."
                         ))

```

 
Modèle logit avec classes latentes C1 et C2 

```{r, echo=FALSE}
latent_classes <- readRDS("../data/latent_classes.rds")

actives_autres <- c("quantile_nivie","revenus_financiers","revenus_locatifs","presta_rsa","presta_chomage","presta_apl","presta_handi","presta_etudes", "presta_hlm")
actives_subj <- c("subj_pauvrete_et_risque", "subj_inf_mini_decla")
actives <- c(actives_subj,actives_autres)
passives <- c("statut_occup", "diplome", "conn_rsa","annee_fac", "prof_statut_act", "age_tranche","vie_fam"#,"presta_handi",
              )

num_indiv <- bdd_logit %>% 
  dplyr::select(c(all_of("ident"),all_of(actives),all_of(passives))) %>% 
  tidyr::drop_na() %>% dplyr::select(ident) %>% pull()

bdd_poLCA_rmnasup_comp <- bdd_logit %>% 
  mutate(s_sentpauvrisque = as.numeric(subj_pauvrete_et_risque),
         s_infminidecla = ifelse(as.numeric(subj_inf_mini_decla)==2,1,2),
         #m_quantilenivie = as.numeric(quantile_nivie),
         m_quantilenivie = as.numeric(substr(quantile_nivie,11,11)),
         # m_quantilenivie_inv = 6-as.numeric(quantile_nivie),
         m_quantilenivie_inv = 6-as.numeric(substr(quantile_nivie,11,11)),
         m_locatif = as.numeric(revenus_locatifs),
         m_locatif_inv = 3-as.numeric(revenus_locatifs),
         m_financier = as.numeric(revenus_financiers),
         m_financier_inv = 3-as.numeric(revenus_financiers),
         i_log = as.numeric(presta_apl),
         i_rsa = as.numeric(presta_rsa),
         i_chom = as.numeric(presta_chomage),
         i_handi = as.numeric(presta_handi),
         i_bourse = as.numeric(presta_etudes),
         i_hlm = as.numeric(presta_hlm),
  ) %>% filter(ident%in%num_indiv) %>% 
  cbind(latent_classes) %>% 
  filter(latent_classes%in%c("C.1","C.2")) %>% 
  mutate(latent_classes=ifelse(latent_classes=="C.1",FALSE,TRUE))

# run_regression(x=c(
#   "quantile_nivie",
#   #"presta_rsa","presta_apl","presta_chomage", "presta_handi",
# "statut_occup0","prof_statut_act","est_emploiprecaire", "diplome", "age_tranche","vie_fam", "sexe", "annee_fac"), #"conn_rsa"
#                        y="latent_classes", type_mod = "logit", bdd_log=bdd_poLCA_rmnasup_comp, kable=TRUE)

tab_latent <- run_regression(x=c(
  "quantile_nivie",
  #"presta_rsa","presta_apl","presta_chomage", "presta_handi", 
"statut_occup0","prof_statut_act","est_emploiprecaire", "diplome", "age_tranche","vie_fam", "sexe", "annee_fac"), #"conn_rsa"
                       y="latent_classes", type_mod = "logit", bdd_log=bdd_poLCA_rmnasup_comp, kable=FALSE) %>% 
  mutate(odds_ratio = ifelse(
    !is.na(valeur),paste0(gsub("\\.",",",odds),pvaleur),"Réf."
  )) %>% 
  dplyr::select(modalite_y,modalite,odds_ratio) %>% 
  slice(-1) %>% 
  arrange(match(modalite, c(modalite[2],modalite[-2]))) %>% 
  arrange(match(modalite, c(modalite[1:7],modalite[9:10],modalite[8],modalite[11:44]))) %>% 
  arrange(match(modalite, c(modalite[1:19],modalite[21],modalite[20],modalite[22:44])))  %>% 
  arrange(match(modalite, c(modalite[1:23],modalite[25],modalite[24],modalite[26:44])))  %>% 
  arrange(match(modalite, c(modalite[1:29],modalite[31],modalite[30],modalite[32:44]))) %>% 
  mutate(modalite_y = c("Niveau de vie",rep("",4),"Logement",rep("",1), "Situation professionnelle",rep("",9),"Précarité de l'emploi","(subjective)","Niveau de diplôme le plus élevé",rep("",3), "Classe d'âge",rep("",5),"Situation familiale",rep("",5),"Sexe",rep("",1),"Année",rep("",4))) %>% setNames(c("Modèle logit", "Variable dépendante : appartenir à la classe C.2 plutôt que C.1", "Odds ratio")) 

saveRDS(tab_latent,"../rapport/figures/tab_latent.RDS")

tab_latent %>%
  kable(caption="Influence des caractéristiques sociales sur l'appartenance à la classe C.2 plutôt que C.1", booktabs = TRUE, longtable = TRUE) %>%
   kableExtra::column_spec(1, width = "4cm") %>%
   kableExtra::column_spec(2, width = "6cm") %>%
   kableExtra::column_spec(3, width = "4cm") %>%
  kableExtra::kable_styling(
  latex_options = c("hold_position", "repeat_header"),
  repeat_header_text = "\\textit{(suite)}",
  repeat_header_continued = "\\textit{(suite en page suivante...)}"
  ) %>%
  kableExtra::footnote(c(paste0("N = ",
                                 "4305"," et $R^2$ ajusté = ","28,0", "%."),"* : significatif au seuil de 5 % ; ** : 1 % ; *** : 0,1 %."
                         ))
```


# Notes méthodologiques

Pour ces modèles cinq vagues du Baromètre ont été empilées : 2015, 2016, 2017, 2018 et 2019 (15 137 observations). Le nombre d'observations utilisées est différent dans chaque modèle, il s'agit uniquement des individus où toutes les variables utilisées dans les modèles sont renseignées (voir notes en bas des tableaux).

# Bibliographie {.unnumbered}

- http://larmarange.github.io/analyse-R/regression-logistique.html : pour aller plus loin dans la mise en forme des sorties de régression
- https://stats.idre.ucla.edu/r/dae/multinomial-logistic-regression/ multinomial regression
- https://www.google.com/url?sa=t&rct=j&q=&esrc=s&source=web&cd=&ved=2ahUKEwi_rruYtI_xAhUPLBoKHbXfBnYQFnoECAIQAA&url=https%3A%2F%2Fatm.amegroups.com%2Farticle%2Fdownload%2F42812%2Fpdf&usg=AOvVaw3r_pG34FuohTLVbkEBdKZJ multinomial versus ordinal regression
- https://www.analyticsvidhya.com/blog/2016/02/multinomial-ordinal-logistic-regression/ multinomial versus ordinal regression
- https://stats.idre.ucla.edu/r/dae/ordinal-logistic-regression/ interprétation régression logistique ordinale
- https://cran.r-project.org/web/packages/naniar/vignettes/getting-started-w-naniar.html et https://naniar.njtierney.com/articles/naniar-visualisation.html package naniar pour les données manquantes
- Biblio sum/deviation coding https://marissabarlaz.github.io/portfolio/contrastcoding/ https://talklab.psy.gla.ac.uk/tvw/catpred/  https://stats.idre.ucla.edu/r/library/r-library-contrast-coding-systems-for-categorical-variables/ https://support.minitab.com/en-us/minitab/18/help-and-how-to/modeling-statistics/regression/supporting-topics/regression-models/interpreting-the-estimated-coefficients-in-binary-logistic-regression/ http://rstudio-pubs-static.s3.amazonaws.com/84447_78d14ecc27674c08b35907fc458ccdc4.html https://www.lexjansen.com/nesug/nesug07/sa/sa11.pdf  https://stackoverflow.com/questions/39802426/how-to-set-contrasts-for-my-variable-in-regression-analysis-with-r 
